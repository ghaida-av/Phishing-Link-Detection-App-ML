<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phishing Link Detector - ML Edition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1976D2 0%, #1565C0 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 500px;
            text-align: center;
        }

        h1 {
            color: #1976D2;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        input[type="text"] {
            width: 100%;
            padding: 14px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #1976D2;
        }

        button {
            width: 100%;
            padding: 14px;
            background: #1976D2;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        button:hover {
            background: #1565C0;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .result {
            margin-top: 25px;
            padding: 20px;
            border-radius: 8px;
            min-height: 100px;
        }

        .result.hidden {
            display: none;
        }

        .result-text {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .result.safe .result-text {
            color: #4CAF50;
        }

        .result.phishing .result-text {
            color: #f44336;
        }

        .confidence {
            color: #666;
            font-size: 14px;
            margin-top: 10px;
        }

        .info {
            margin-top: 15px;
            padding: 12px;
            background: #f5f5f5;
            border-radius: 6px;
            font-size: 13px;
            color: #666;
            text-align: left;
        }

        .loading {
            color: #1976D2;
            font-size: 16px;
        }

        .error {
            color: #f44336;
            font-size: 14px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ°Ô∏è Phishing Detector</h1>

        <div class="input-group">
            <input 
                type="text" 
                id="linkInput" 
                placeholder="Enter URL or email address"
                autocomplete="off"
            >
        </div>

        <button id="checkBtn" onclick="checkLink()">Check Link</button>

        <div id="result" class="result hidden">
            <div class="result-text" id="resultText"></div>
            <div class="confidence" id="confidence"></div>
            <div class="info" id="info"></div>
            <div class="error" id="error"></div>
        </div>
    </div>

    <script>
        // -------------------------
        // Beginner-friendly helpers
        // -------------------------
        function normalizeUrl(url) {
            // The browser URL(...) needs a protocol. If missing, add http://
            return url.includes('://') ? url : 'http://' + url;
        }

        function safeParseUrl(url) {
            try {
                return new URL(normalizeUrl(url));
            } catch (e) {
                return null;
            }
        }

        // Feature extraction (simplified version matching Android app)
        function extractFeatures(url) {
            const urlLower = url.toLowerCase();
            const features = [];

            // Basic URL features (10)
            features.push(url.length);
            features.push((url.match(/\./g) || []).length);
            features.push((url.match(/-/g) || []).length);
            features.push((url.match(/_/g) || []).length);
            features.push((url.match(/\//g) || []).length);
            features.push((url.match(/\?/g) || []).length);
            features.push((url.match(/=/g) || []).length);
            features.push((url.match(/@/g) || []).length);
            features.push((url.match(/&/g) || []).length);

            // Protocol features (3)
            features.push(url.startsWith('https://') ? 1 : 0);
            features.push(url.startsWith('http://') ? 1 : 0);
            features.push(urlLower.includes('https') ? 1 : 0);

            // Suspicious keywords (1) - enhanced
            const suspiciousKeywords = ['login', 'verify', 'bank', 'secure', 'account', 
                                       'update', 'confirm', 'suspend', 'click', 'here',
                                       'free', 'win', 'prize', 'urgent', 'limited',
                                       'password', 'reset', 'unlock', 'activate', 'validate',
                                       'security', 'alert', 'warning', 'expired', 'locked'];
            const keywordCount = suspiciousKeywords.filter(kw => urlLower.includes(kw)).length;
            features.push(keywordCount);

            // Additional phishing patterns (3 features)
            // URL shortening services abuse
            const urlShorteners = ['bit.ly', 'tinyurl', 'goo.gl', 't.co', 'ow.ly'];
            features.push(urlShorteners.some(short => urlLower.includes(short)) ? 1 : 0);
            
            // Multiple suspicious patterns combined
            const hasMultipleSuspicious = keywordCount > 2 && (url.match(/-/g) || []).length > 2;
            features.push(hasMultipleSuspicious ? 1 : 0);
            
            // Path contains suspicious patterns
            const suspiciousPathPatterns = ['/login', '/verify', '/secure', '/account', '/update'];
            let hasSuspiciousPath = false;
            try {
                const urlObj = safeParseUrl(url);
                if (!urlObj) throw new Error('Invalid URL');
                hasSuspiciousPath = suspiciousPathPatterns.some(pattern => urlObj.pathname.toLowerCase().includes(pattern));
            } catch (e) {
                // ignore
            }
            features.push(hasSuspiciousPath ? 1 : 0);

            // Domain features (8) - enhanced
            try {
                const urlObj = safeParseUrl(url);
                if (!urlObj) throw new Error('Invalid URL');
                const domain = urlObj.hostname || urlObj.pathname.split('/')[0];
                const domainLower = domain.toLowerCase();
                
                features.push(domain.length);
                features.push((domain.match(/\./g) || []).length);
                
                // IP pattern
                const ipPattern = /\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/;
                features.push(ipPattern.test(domain) ? 1 : 0);
                
                // Suspicious TLDs (enhanced)
                const suspiciousTlds = ['.tk', '.ml', '.ga', '.cf', '.gq', '.xyz', '.top', '.click'];
                features.push(suspiciousTlds.some(tld => domainLower.includes(tld)) ? 1 : 0);
                
                // Common domains (typosquatting indicator)
                const commonDomains = ['google', 'facebook', 'amazon', 'microsoft', 'apple', 'paypal',
                                     'netflix', 'twitter', 'instagram', 'linkedin', 'ebay', 'yahoo'];
                features.push(commonDomains.some(cd => domainLower.includes(cd)) ? 1 : 0);
                
                // Typosquatting pattern detection
                const typosquattingPatterns = ['go0gle', 'g00gle', 'faceb00k', 'amaz0n', 'micr0soft',
                                              'paypa1', 'app1e', 'tw1tter', '1nstagram'];
                features.push(typosquattingPatterns.some(pattern => domainLower.includes(pattern)) ? 1 : 0);
                
                // Subdomain abuse (multiple subdomains)
                const subdomainCount = (domain.match(/\./g) || []).length - 1;
                features.push(subdomainCount > 2 ? 1 : 0);
                
                // Hyphen in domain (suspicious)
                features.push(domain.includes('-') ? 1 : 0);
            } catch (e) {
                features.push(0, 0, 0, 0, 0, 0, 0, 0);
            }

            // Path features (2)
            try {
                const urlObj = safeParseUrl(url);
                if (!urlObj) throw new Error('Invalid URL');
                const path = urlObj.pathname;
                features.push(path.length);
                features.push((path.match(/\//g) || []).length);
            } catch (e) {
                features.push(0, 0);
            }

            // Query features (2)
            try {
                const urlObj = safeParseUrl(url);
                if (!urlObj) throw new Error('Invalid URL');
                const query = urlObj.search.substring(1);
                features.push(query.length);
                features.push((query.match(/&/g) || []).length);
            } catch (e) {
                features.push(0, 0);
            }

            // Port (1)
            try {
                const urlObj = safeParseUrl(url);
                if (!urlObj) throw new Error('Invalid URL');
                const port = urlObj.port;
                features.push(port && port !== '80' && port !== '443' ? 1 : 0);
            } catch (e) {
                features.push(0);
            }

            // Ratios (2)
            const digitCount = (url.match(/\d/g) || []).length;
            features.push(url.length > 0 ? digitCount / url.length : 0);
            
            const letterCount = (url.match(/[a-zA-Z]/g) || []).length;
            features.push(url.length > 0 ? letterCount / url.length : 0);

            return features;
        }

        // Enhanced ML-based detection using all phishing patterns
        function detectPhishing(url) {
            const features = extractFeatures(url);
            
            // Comprehensive scoring based on all features
            let score = 0;
            
            // URL length (longer = more suspicious, but not the only factor)
            if (features[0] > 75) score += 0.1;
            if (features[0] > 100) score += 0.15;
            
            // Suspicious keywords (weighted by count)
            score += Math.min(features[13] * 0.12, 0.4); // Cap at 0.4
            
            // URL shorteners (highly suspicious)
            if (features[14] === 1) score += 0.25;
            
            // Multiple suspicious patterns combined
            if (features[15] === 1) score += 0.3;
            
            // Suspicious path patterns
            if (features[16] === 1) score += 0.2;
            
            // Suspicious TLDs (highly suspicious)
            if (features[20] === 1) score += 0.35;
            
            // IP address in domain (very suspicious)
            if (features[19] === 1) score += 0.3;
            
            // Typosquatting patterns (very suspicious)
            if (features[22] === 1) score += 0.4;
            
            // Subdomain abuse
            if (features[23] === 1) score += 0.2;
            
            // Hyphen in domain (moderate suspicion)
            if (features[24] === 1) score += 0.15;
            
            // Common domain with suspicious patterns (typosquatting)
            if (features[21] === 1 && (features[22] === 1 || features[20] === 1)) {
                score += 0.3; // Common domain + suspicious TLD/typo = very suspicious
            }
            
            // Non-standard port
            if (features[27] === 1) score += 0.1;
            
            // High digit ratio (obfuscation)
            if (features[28] > 0.3) score += 0.15;
            
            // Contains @ (only moderate weight, not the main factor)
            if (features[7] > 0) score += 0.15; // Reduced from 0.4
            
            // No HTTPS (moderate)
            if (features[9] === 0 && features[10] === 0) score += 0.1;
            
            // Multiple hyphens (suspicious)
            if (features[2] > 3) score += 0.15;
            
            // Normalize score to 0-1
            const probability = Math.min(score, 1.0);
            const isPhishing = probability > 0.5;
            const confidence = isPhishing ? probability : (1 - probability);
            
            return { isPhishing, confidence: Math.max(confidence, 0.5) };
        }

        function checkLink() {
            const input = document.getElementById('linkInput');
            const resultDiv = document.getElementById('result');
            const resultText = document.getElementById('resultText');
            const confidenceDiv = document.getElementById('confidence');
            const infoDiv = document.getElementById('info');
            const errorDiv = document.getElementById('error');
            const checkBtn = document.getElementById('checkBtn');
            
            const url = input.value.trim();
            
            if (!url) {
                errorDiv.textContent = 'Please enter a URL or email';
                resultDiv.classList.remove('hidden', 'safe', 'phishing');
                resultDiv.classList.add('phishing');
                resultText.textContent = '‚ùå Invalid Input';
                return;
            }

            // Show loading
            checkBtn.disabled = true;
            resultDiv.classList.remove('hidden', 'safe', 'phishing');
            resultText.textContent = 'Checking...';
            resultText.className = 'result-text loading';
            confidenceDiv.textContent = '';
            infoDiv.textContent = '';
            errorDiv.textContent = '';

            // Simulate processing delay
            setTimeout(() => {
                try {
                    const { isPhishing, confidence } = detectPhishing(url);
                    
                    resultDiv.classList.remove('hidden');
                    resultDiv.classList.add(isPhishing ? 'phishing' : 'safe');
                    
                    if (isPhishing) {
                        resultText.textContent = '‚ö† PHISHING DETECTED';
                        resultText.style.color = '#f44336';
                    } else {
                        resultText.textContent = '‚úÖ SAFE URL';
                        resultText.style.color = '#4CAF50';
                    }
                    
                    const urlType = url.includes('@') ? 'Email' : 'URL';
                    const displayUrl = url.length > 50 ? url.substring(0, 50) + '...' : url;
                    infoDiv.innerHTML = `
                        <strong>Type:</strong> ${urlType}<br>
                        <strong>Analyzed:</strong> ${displayUrl}
                    `;
                    
                } catch (e) {
                    errorDiv.textContent = 'Error: ' + e.message;
                    resultDiv.classList.add('phishing');
                    resultText.textContent = '‚ùå Error';
                } finally {
                    checkBtn.disabled = false;
                }
            }, 300);
        }

        // Allow Enter key to trigger check
        document.getElementById('linkInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkLink();
            }
        });
    </script>
</body>
</html>
